R=0:0.001:2;
Z=0.5;
nu=0.2;gamma=3.2453;beta=2.9247;H=0.8;
delta=3-4.*nu;
delta2=1-nu;
delta3=1-2.*nu;
A=delta+(1./delta);
B=4./delta;
C=(((delta-1).^2)./delta)+(delta./(delta+1).^2)+1;
I1=3.*delta.*(Z.^2).*R./(Z.^2+R.^2).^(5/2);
A1=Z+2.*H;
I2=-4.*delta2.*delta3.*R./(A1.^2+R.^2).^(3/2)-....
3.*Z.*R.*A1.*(1-A.*delta)./(A1.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A1.^2).*R.*H.*(Z-H)./(A1.^2+R.^2).^(7/2)-....
15.*delta.*B.*Z.*H.^2.*R.*A1.*(3.*R.^2-4.*A1.^2)./(A1.^2+R.^2).^(9/2);
A2=Z+4.*H;
I3=-4.*delta2.*delta3.*A.*R./(A2.^2+R.^2).^(3/2)-....
3.*A.*Z.*R.*A2./(A2.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A2.^2).*R.*H.*(A.*(Z-H)-2.*B.*H.*delta2.*delta3)./(A2.^2+R.^2).^(7/2)+....
15.*B.*Z.*H.^2.*R.*A2.*(3.*R.^2-4.*A2.^2)./(A2.^2+R.^2).^(9/2)+....
90.*R.*B.*H.^3.*(Z-H).*(8.*A2.^4-12.*A2.^2.*R.^2+R.^4)./(A2.^2+R.^2).^(11/2);
A3=Z+gamma.*H;
I4=delta.*(3.*C.*Z.*R.*A3./(A3.^2+R.^2).^(5/2)-...
15.*beta.*Z.*H.^2.*R.*A3.*(3.*R.^2-4.*A3.^2)./(A3.^2+R.^2).^(9/2));
A4=Z+(gamma+2).*H;
I5=-4.*delta2.*delta3.*C.*R./(A4.^2+R.^2).^(3/2)-....
3.*C.*Z.*R.*A4./(A4.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A4.^2).*R.*H.*(C.*(Z-H)-2.*beta.*H.*delta2.*delta3)./(A4.^2+R.^2).^(7/2)+....
15.*beta.*Z.*H.^2.*R.*A4.*(3.*R.^2-4.*A4.^2)./(A4.^2+R.^2).^(9/2)+....
90.*R.*beta.*H.^3.*(Z-H).*(8.*A4.^4-12.*A4.^2.*R.^2+R.^4)./(A4.^2+R.^2).^(11/2);
A5=2.*H-Z;
I6=-4.*delta2.*delta3.*R./(A5.^2+R.^2).^(3/2)+....
3.*Z.*R.*A5./(A5.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A5.^2).*R.*H.*(Z-H)./(A5.^2+R.^2).^(7/2);
A6=4.*H-Z;
I7=-4.*delta2.*delta3.*A.*R./(A6.^2+R.^2).^(3/2)+....
3.*(A-delta).*Z.*R.*A6./(A6.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A6.^2).*R.*H.*(A.*(Z-H)-2.*B.*H.*delta2.*delta3)./(A6.^2+R.^2).^(7/2)-....
15.*B.*Z.*H.^2.*R.*A6.*(3.*R.^2-4.*A6.^2)./(A6.^2+R.^2).^(9/2)+....
90.*R.*B.*H.^3.*(Z-H).*(8.*A6.^4-12.*A6.^2.*R.^2+R.^4)./(A6.^2+R.^2).^(11/2);
A7=6.*H-Z;
I8=delta.*(3.*A.*Z.*R.*A7./(A7.^2+R.^2).^(5/2)-....
15.*B.*Z.*H.^2.*R.*A7.*(3.*R.^2-4.*A7.^2)./(A7.^2+R.^2).^(9/2));
A8=(gamma+2).*H-Z;
I9=-4.*delta2.*delta3.*C.*R./(A8.^2+R.^2).^(3/2)+....
3.*C.*Z.*R.*A8./(A8.^2+R.^2).^(5/2)-....
6.*(R.^2-4.*A8.^2).*R.*H.*(C.*(Z-H)-2.*beta.*H.*delta2.*delta3)./(A8.^2+R.^2).^(7/2)-....
15.*beta.*Z.*H.^2.*R.*A8.*(3.*R.^2-4.*A8.^2)./(A8.^2+R.^2).^(9/2)+....
90.*R.*beta.*H.^3.*(Z-H).*(8.*A8.^4-12.*A8.^2.*R.^2+R.^4)./(A8.^2+R.^2).^(11/2);
A9=(gamma+4).*H-Z;
I10=delta.*(3.*C.*Z.*R.*A9./(A9.^2+R.^2).^(5/2)-....
15.*beta.*Z.*H.^2.*R.*A9.*(3.*R.^2-4.*A9.^2)./(A9.^2+R.^2).^(9/2));
sigma=(-I1+I2-I3-I4+I5-I6+I7+I8-I9-I10)./2;
Sigmarz=real(sigma);
XX=[R;Sigmarz];
fid=fopen('F8.txt','wt');
fprintf(fid,'%-10.6f %-10.6f \n',XX);
fclose(fid);
% subplot(3,2,1)
%       plot(X,SIGMA11)
%      hold on
% plot(X,SIGMA12)
% hold on
% subplot(3,2,2)
   plot(R,Sigmarz)
   xlabel('R'); ylabel('Dimensionless shear stress (\Sigma_{rz})');
   hold on
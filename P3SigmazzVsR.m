R=0:0.001:2;
Z=0.5;
nu=0.2;gamma=3.2453;beta=2.9247;H=0.8;
delta=3-4.*nu;
delta2=(1-2.*nu).^2+4.*(1-nu).^2;
A=delta+(1./delta);
B=4./delta;
C=(((delta-1).^2)./delta)+(delta./(delta+1).^2)+1;
I1=delta.*(Z./(Z.^2+R.^2).^(3/2)+Z.*(2.*Z.^2-R.^2)./(Z.^2+R.^2).^(5/2));
A1=Z+2.*H;
I2=(delta.*A-delta2).*A1./(A1.^2+R.^2).^(3/2)-....
(2.*A1.^2-R.^2).*(Z.*(1-A.*delta)-2.*H)./(A1.^2+R.^2).^(5/2)+....
3.*(2.*A1.^2-3.*R.^2).*A1.*H.*(2.*(Z-H)+delta.*B.*H)./(A1.^2+R.^2).^(7/2)+....
3.*delta.*B.*Z.*H.^2.*(8.*A1.^4-24.*A1.^2.*R.^2+3.*R.^4)./(A1.^2+R.^2).^(9/2);
A2=Z+4.*H;
I3=-delta2.*A.*A2./(A2.^2+R.^2).^(3/2)-....
(2.*A2.^2-R.^2).*A.*(Z-2.*H)./(A2.^2+R.^2).^(5/2)+....
3.*(2.*A2.^2-3.*R.^2).*A2.*H.*(2.*A.*(Z-H)-B.*H.*delta2)./(A2.^2+R.^2).^(7/2)-....
3.*B.*H.^2.*(Z-2.*H).*(8.*A2.^4-24.*A2.^2.*R.^2+3.*R.^4)./(A2.^2+R.^2).^(9/2)+....
30.*A2.*B.*H.^3.*(Z-H).*(8.*A2.^4-40.*A2.^2.*R.^2+15.*R.^4)./(A2.^2+R.^2).^(11/2);
A3=Z+gamma.*H;
I4=C.*A3./(A3.^2+R.^2).^(3/2)+....
(2.*A3.^2-R.^2).*C.*Z./(A3.^2+R.^2).^(5/2)+....
3.*beta.*(2.*A3.^2-3.*R.^2).*A3.*H.^2./(A3.^2+R.^2).^(7/2)+....
3.*beta.*Z.*H.^2.*(8.*A3.^4-24.*A3.^2.*R.^2+3.*R.^4)./(A3.^2+R.^2).^(9/2);
A4=Z+(gamma+2).*H;
I5=-delta2.*C.*A4./(A4.^2+R.^2).^(3/2)-....
(2.*A4.^2-R.^2).*C.*(Z-2.*H)./(A4.^2+R.^2).^(5/2)+....
3.*(2.*A4.^2-3.*R.^2).*A4.*H.*(2.*C.*(Z-H)-beta.*H.*delta2)./(A4.^2+R.^2).^(7/2)-....
3.*beta.*H.^2.*(Z-2.*H).*(8.*A4.^4-24.*A4.^2.*R.^2+3.*R.^4)./(A4.^2+R.^2).^(9/2)+....
30.*A4.*beta.*H.^3.*(Z-H).*(8.*A4.^4-40.*A4.^2.*R.^2+15.*R.^4)./(A4.^2+R.^2).^(11/2);
A5=2.*H-Z;
I6=-delta2.*A5./(A5.^2+R.^2).^(3/2)-....
(2.*A5.^2-R.^2).*A5./(A5.^2+R.^2).^(5/2)+....
6.*(2.*A5.^2-3.*R.^2).*A5.*H.*(Z-H)./(A5.^2+R.^2).^(7/2);
A6=4.*H-Z;
I7=(delta-delta2.*A).*A6./(A6.^2+R.^2).^(3/2)+....
(2.*A6.^2-R.^2).*(Z.*(A-delta)-2.*H.*A)./(A6.^2+R.^2).^(5/2)+....
3.*(2.*A6.^2-3.*R.^2).*A6.*H.*(2.*A.*(Z-H)-B.*H.*delta2)./(A6.^2+R.^2).^(7/2)+....
3.*B.*H.^2.*(Z-2.*H).*(8.*A6.^4-24.*A6.^2.*R.^2+3.*R.^4)./(A6.^2+R.^2).^(9/2)+....
30.*A6.*B.*H.^3.*(Z-H).*(8.*A6.^4-40.*A6.^2.*R.^2+15.*R.^4)./(A6.^2+R.^2).^(11/2);
A7=6.*H-Z;
I8=delta.*(3.*B.*H.^2.*Z.*(8.*A7.^4-24.*A7.^2.*R.^2+3.*R.^4)./(A7.^2+R.^2).^(9/2)-....
3.*(2.*A7.^2-3.*R.^2).*B.*A7.*H.^2./(A7.^2+R.^2).^(7/2)+....
(2.*A7.^2-R.^2).*Z.*A./(A7.^2+R.^2).^(5/2)-....
A.*A7./(A7.^2+R.^2).^(3/2));
A8=(gamma+2).*H-Z;
I9=-delta2.*C.*A8./(A8.^2+R.^2).^(3/2)+....
(2.*A8.^2-R.^2).*C.*(Z-2.*H)./(A8.^2+R.^2).^(5/2)+....
3.*(2.*A8.^2-3.*R.^2).*A8.*H.*(2.*C.*(Z-H)-beta.*H.*delta2)./(A8.^2+R.^2).^(7/2)+....
3.*beta.*H.^2.*(Z-2.*H).*(8.*A8.^4-24.*A8.^2.*R.^2+3.*R.^4)./(A8.^2+R.^2).^(9/2)+....
30.*A8.*beta.*H.^3.*(Z-H).*(8.*A8.^4-40.*A8.^2.*R.^2+15.*R.^4)./(A8.^2+R.^2).^(11/2);
A9=(gamma+4).*H-Z;
I10=delta.*(3.*beta.*H.^2.*Z.*(8.*A9.^4-24.*A9.^2.*R.^2+3.*R.^4)./(A9.^2+R.^2).^(9/2)-....
3.*(2.*A9.^2-3.*R.^2).*beta.*A9.*H.^2./(A9.^2+R.^2).^(7/2)+....
(2.*A9.^2-R.^2).*Z.*C./(A9.^2+R.^2).^(5/2)-....
C.*A9./(A9.^2+R.^2).^(3/2));
sigma=(-I1+I2-I3-I4+I5+I6-I7-I8+I9+I10)./2;
Sigmazz=real(sigma);
XX=[R;Sigmazz];
fid=fopen('F8.txt','wt');
fprintf(fid,'%-10.6f %-10.6f \n',XX);
fclose(fid);
% subplot(3,2,1)
%       plot(X,SIGMA11)
%      hold on
% plot(X,SIGMA12)
% hold on
% subplot(3,2,2)
   plot(R,Sigmazz)
     xlabel('R'); ylabel('Dimensionless vertical stress (\Sigma_{zz})');
   hold on